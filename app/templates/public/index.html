{% extends "public/template.html" %} {% block title %}Main App{% endblock %} {%
block main %}
<!--   Big container   -->
<div class="container">
  <div class="row text-center">
    <h2>Excel data cleaner</h2>
    <h4>
      Perbaiki data excel dari format format. Upload satu file excel dan temukan
      perbedaannya
    </h4>
    {% if feedback %}
    <p class="text-{{status}}">{{feedback}}</p>

    {% endif %}
  </div>
  <div class="row outer-box border text-center">
    {% if status=='success' %}
    <div class="m-5">
      <a
        class="btn-submit"
        href="{{url_for('static', filename=filenamesuccess)}}"
        >Download File</a
      >
    </div>
    {% endif %}
    <div class="row inner-box border text-center">
      {% if status=='success' %} {%for i in range(0, 1)%}
      <div class="table">
        <table id="DataTable" class="cell-border" style="width: 100%">
          <thead>
            <th>No.</th>
            {%for i in range(0, column|length)%}
            <th>{{column[i]}}</th>
            {%endfor%}
          </thead>
          <!-- prettier-ignore -->
          <tbody>
              {%for i in range(0, df_processed|length)%}
              <tr>
                <td>{{i}}</td>
                {%for j in range(0, df_processed[i]|length)%}
                <td
                  {% if (df_upload[i][j] != df_processed[i][j]) or (df_upload[i][j] == "") %}
                  class="beda"
                  {% endif %}
                >
                <p style="font-weight: bold;">
                    {{df_processed[i][j]}} 
                </p>
                {% if df_upload[i][j] != df_processed[i][j] %}
                <p style="color: rgb(80, 80, 80);">Data Sebelumnya : {{df_upload[i][j]}}</p>
                {% endif %}
                </td>
                {%endfor%}
              </tr>
              {%endfor%}
            </tbody>
          {%endfor%}
        </table>
      </div>
      {% else %}
      <form
        class="form-custom"
        action="/upload"
        method="post"
        enctype="multipart/form-data"
      >
        <p id="filename"></p>
        <label
          class="custom-file-upload"
          for="excel_file"
          id="label-input-file"
        >
          <i class="fa fa-file-text-o" aria-hidden="true"></i>
          <span class="text-input-file">Choose File</span>
        </label>
        <input type="file" id="excel_file" name="excel_file" />
        <input type="submit" class="btn-submit" value="Start" id="btn-submit" />
      </form>
      {% endif %}
    </div>
  </div>
</div>
<!--  big container -->

{% endblock %} {% block script %}
<script>
  $("#DataTable").DataTable({
    paging: false,
    ordering: false,
    info: false,
    searching: false,
    fixedColumns: {
      left: 1,
    },
  });
  $("#btn-submit").hide();
  $("#excel_file").change(function () {
    let i = $("#excel_file")[0].files[0].name;
    $("#filename").text(i);
    $("#label-input-file").hide();
    $("#btn-submit").show();
  });
</script>
{% endblock %}
