{% extends "public/template.html" %} {% block title %}Main App{% endblock %} {%
block main %}
<!--   Big container   -->
<div class="container">
  <div class="row text-center">
    <div class="row" style="display: inline; width: 100%">
      <h2>Excel data cleaner</h2>
    </div>
    <h4>
      Perbaiki data excel dari format format. Upload satu file excel dan temukan
      perbedaannya
    </h4>
    {% if feedback %}
    <p class="text-{{status}}">{{feedback}}</p>

    {% endif %}
  </div>
  <div class="row outer-box border text-center">
    {% if status=='success' %}
    <div class="m-5 w-100">
      <a class="btn-submit" href="{{url_for('static', filename=filenameXlsx)}}"
        >Download File (xlsx)</a
      >
      <a class="btn-submit" href="{{url_for('static', filename=filenameCsv)}}"
        >Download File (csv)</a
      >
    </div>
    {% endif %}
    <div class="row inner-box border text-center w-100">
      {% if status=='success' %} {% with
      column=column,df_processed=df_processed,df_uppload=df_processed %} {%
      include "public/table.html" %} {% endwith %} {% else %}
      <form
        class="form-custom"
        action="/upload"
        method="post"
        enctype="multipart/form-data"
      >
        <p id="filename"></p>
        <label
          class="custom-file-upload"
          for="excel_file"
          id="label-input-file"
        >
          <i class="fa fa-file-text-o" aria-hidden="true"></i>
          <span class="text-input-file">Choose File</span>
        </label>
        <input type="file" id="excel_file" name="excel_file" />
        <input type="submit" class="btn-submit" value="Start" id="btn-submit" />
      </form>
      {% endif %}
    </div>
  </div>
</div>
<!--  big container -->

{% endblock %} {% block script %}
<script>
  $("#DataTable").DataTable({
    paging: false,
    ordering: false,
    info: false,
    searching: false,
    fixedColumns: {
      left: 1,
    },
  });
  $("#btn-submit").hide();
  $("#excel_file").change(function () {
    let i = $("#excel_file")[0].files[0].name;
    $("#filename").text(i);
    $("#label-input-file").hide();
    $("#btn-submit").show();
  });
</script>
{% endblock %}
